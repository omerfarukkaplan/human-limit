<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Human Limit</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body {
  margin:0;
  background:#0f0f0f;
  font-family:Arial;
  color:white;
  text-align:center;
}

h1 {
  margin-top:80px;
  font-size:48px;
  letter-spacing:4px;
}

input {
  padding:12px;
  width:300px;
  background:#1c1c1c;
  border:1px solid #333;
  color:white;
  margin-top:20px;
}

button {
  padding:12px 30px;
  margin-top:20px;
  background:#00ffcc;
  border:none;
  cursor:pointer;
  font-weight:bold;
  transition:0.3s;
}

button:hover {
  background:#00ccaa;
}

#gameArea {
  margin-top:60px;
}
</style>
</head>

<body>

<h1>HUMAN LIMIT</h1>

<input id="email" placeholder="Enter your email" />
<br>
<button id="startBtn">Start</button>

<div id="gameArea"></div>

<script>

// SUPABASE CONFIG
const supabaseUrl = "BURAYA_SUPABASE_URL";
const supabaseKey = "BURAYA_PUBLIC_ANON_KEY";

const supabase = supabase.createClient(supabaseUrl, supabaseKey);

document.getElementById("startBtn").addEventListener("click", async () => {

  const email = document.getElementById("email").value;

  if(!email) return alert("Email required");

  // Kullanıcı kaydet
  await supabase.from("users").insert([{ email: email }]);

  loadMiniGame();
});

function loadMiniGame() {
  const gameArea = document.getElementById("gameArea");

  const randomGame = Math.floor(Math.random()*3);

  if(randomGame === 0) reactionGame();
  if(randomGame === 1) memoryGame();
  if(randomGame === 2) clickSpeedGame();
}

// MINI GAME 1 – Reaction
function reactionGame() {
  const gameArea = document.getElementById("gameArea");
  gameArea.innerHTML = "<h2>Click when screen turns green</h2>";

  setTimeout(()=>{
    document.body.style.background = "green";

    const start = Date.now();

    document.body.onclick = ()=>{
      const reaction = Date.now() - start;
      alert("Reaction: "+reaction+"ms");
      document.body.style.background = "#0f0f0f";
      document.body.onclick = null;
    };

  }, Math.random()*3000+1000);
}

// MINI GAME 2 – Memory
function memoryGame() {
  const number = Math.floor(Math.random()*9000+1000);
  const gameArea = document.getElementById("gameArea");

  gameArea.innerHTML = "<h2>Remember this: "+number+"</h2>";

  setTimeout(()=>{
    gameArea.innerHTML = "<input id='memInput' placeholder='Type number'><br><button onclick='checkMemory("+number+")'>Submit</button>";
  },3000);
}

function checkMemory(num){
  const val = document.getElementById("memInput").value;
  alert(val == num ? "Correct" : "Wrong");
}

// MINI GAME 3 – Click Speed
function clickSpeedGame(){
  const gameArea = document.getElementById("gameArea");
  let clicks = 0;

  gameArea.innerHTML = "<h2>Click as fast as you can (5 seconds)</h2><button id='clickBtn'>Click</button>";

  document.getElementById("clickBtn").onclick = ()=> clicks++;

  setTimeout(()=>{
    alert("Total clicks: "+clicks);
  },5000);
}

</script>

</body>
</html>