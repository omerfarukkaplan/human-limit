<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Human Limit</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
body{background:#0e0e0e;color:white;font-family:Arial;text-align:center}
.card{background:#1a1a1a;padding:40px;width:400px;margin:40px auto;border-radius:12px}
input{padding:10px;width:80%;background:#222;border:none;color:white;margin-top:10px}
button{margin-top:20px;padding:12px 30px;background:#00ffc3;border:none;font-weight:bold;cursor:pointer}
</style>
</head>
<body>

<h1>HUMAN LIMIT</h1>

<div class="card">
<input id="email" placeholder="Email"><br>
<input id="password" type="password" placeholder="Password"><br>
<button id="enterBtn">Enter</button>
</div>

<div id="analysis"></div>

<script>
const { createClient } = supabase;
const client = createClient("https://mzvrzlwyvdfibusjfltf.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im16dnJ6bHd5dmRmaWJ1c2pmbHRmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEyMDYxODksImV4cCI6MjA4Njc4MjE4OX0.Y6c_KVS79tU1TL3ToZj5mfsXo5_UpzFk8rXZicEDFDo");

document.getElementById("enterBtn").addEventListener("click", async ()=>{

  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;

  const { data, error } = await client.auth.signUp({ email, password });
  if(error){ alert(error.message); return; }

  await client.from("users").insert([{ id: data.user.id, email }]);

  await client.from("test_results").insert([{
    user_id: data.user.id,
    reaction_score: Math.floor(Math.random()*100),
    memory_score: Math.floor(Math.random()*100),
    risk_score: Math.floor(Math.random()*100),
    focus_score: Math.floor(Math.random()*100)
  }]);

  const { data: profile } = await client
    .from("personality_profiles")
    .select("*")
    .order("created_at",{ascending:false})
    .limit(1);

  document.getElementById("analysis").innerHTML =
    "<div class='card'><h2>"+profile[0].profile_type+"</h2>"+
    "<p>IQ: "+profile[0].iq_score+"</p>"+
    "<p>Dominance: "+profile[0].dominance_score+"</p>"+
    "<p>Emotional: "+profile[0].emotional_score+"</p>"+
    "<p>"+profile[0].summary+"</p></div>";

});
</script>

</body>
</html>